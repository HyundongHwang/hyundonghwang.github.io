---
layout: post
title: "251005 STREAM 이슈1. 스마트폰 만으로 촬영과 댄스점수평가를 동시에"
comments: true
tags: [STREAM, Unity, AI, 포즈추출, 실시간처리, 댄스평가, MediaPipe]
---

# 데모 영상

먼저 데모 영상을 보시지요.

## `NewJeans - Ditto` iPad에서 연습, 평가, 금메달 수령, 결과 공유

<div class="video-container">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/Kl-6zegfLC8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
</div>

## 금메달 받은 `NewJeans - Ditto` 연습영상 유투브 개인채널 공유

<div class="video-container">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/C94bOfy3t8k" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
</div>

## 금메달 받은 `투어스 - 첫만남은 계획대로 되지 않아` 연습영상 유투브 개인채널 공유

<div class="video-container">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/J2wbMMzB6U8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
</div>

네 그렇습니다.
저도 올해로 45.
당연히 저희 동년배들 사이에선 뉴진스가 짱입니다.
어도어 뉴진스 법적분쟁이 길어져서 너무 아쉽습니다.
뭔가 말로 하긴 어렵지만 뉴진스는 제가 보기엔 다른 KPOP과 좀 좋게 다른 느낌이 있습니다.
STREAM을 하기전엔 주로 차에서 운전하면서 오디오로만 듣고 팬심을 키우다가, 이렇게 당당하게 댄스연습도 할수 있게되어 너무 영광이고 즐거웠습니다.
물론 개발은 바쁘고, 350개 넘는 클래스들의 규격과 패턴이 일정해 지면서, 이렇게 초반처럼 개발과 댄스연습을 함께 할수 있는 필요도 없어지고, 여유는 더 없어 졌습니다.
정말 바빠서 2년간 하루중에 10분이상 시간이 날것 같은 상황이면 무조건 맥북 앞에 앉았습니다.
가끔은 넷플릭스 유투브 좀 보면서 쉬고 싶었지만, 개발은 농사와 같아서, 매일 가서 눈으로 보면 고칠게 있고, 고치면 좋아지는데, 개발자가 자기사업을 하니깐 그냥 24시간 이 생각만 하게 되서 좋기도 하고 나쁜것 같기도 합니다.
오히려 8살인 저희 아들이 저보다 열심히 연습을 했습니다.
저희 아들이 보고한 버그도 꽤 됩니다.
작년4월 출시하고, 몇달간은 저희 아들이 STREAM에 깊이 빠져서 계속 춤추고, 영상 돌려보고, 급기야 와이프가 하루 사용제한 까지 거는 지경에 이르렀습니다.
이때는 그래서 서비스가 무지 잘될줄 알았으나,,, 이 기능도 익숙해 지고, 질리게 되었는지 아들도 잘 찾지 않게 되었습니다.
그리고 이때쯤 이것저것 새로운 기능을 계속 출시 했으나, 생각만큼 유저님들의 반응이 없다보니 비지니스는 정체되긴 했습니다.
비지니스는 제가 잘 모르는 분야지만 언제 따로 포스트로 얘기할 수 있는 기회가 있을것 같습니다.

<br/>
<br/>
<br/>

# 춤? 춤을 잘춘다는 것?

제가 감히 `춤이 무엇이다, 춤을 잘춘다는것은 이것이다.` 라고 얘기해도 될까요?
저는 이 사업전엔 댄스 아카데미, 댄스 연습실을 가본적이 없습니다.
20대때도 골수 공대생에 내향적인 아웃사이더라서 클럽도 못가봤습니다.
30대때 회사 회식을 대표님이 개인소유하신 클럽에서 한적이 있었는데, 도저히 너무 어색해서, 눈치보다가 화장실 가는척 하고 택시잡아타고 언른 귀가 했습니다.
참고로 KPOP 댄스를 배울수 있는 댄스 아카데미, 댄스 연습실은 우리 주위에 엄청 많이 있고 KPOP댄스 차제는 매우 대중화된 취미 입니다.
심지어 네이버지도 검색해 보면 골프존보다 많이 검색 됩니다.
아무튼 저는 `춤이 무엇이다, 춤을 잘춘다는것은 이것이다.` 라는 것을 확실히 안다고 얘기할 수 있습니다.
왜냐면, STREAM에는 댄스영상의 정확도 평가기능이 있고, 이 내부의 로직을 개발했기 때문에 잘 알고 있다고 할 수 있습니다.
약간 질문을 바꿔서 누군가에게 보컬, 피아노 연주, 기타 연주를 듣고 평가를 해 달라면 대개 좀더 쉽게 평가할 수 있다고 할 것입니다.
차이는 뭘까요?
보컬, 피아노, 기타 에는 좀더 인식하기 쉬운 패턴이 존재하고, 이 패턴이 소수로 축약되고 각 패턴들은 청자의 심리패턴과 직결되게 구성되어 있어서 그렇습니다.
예를 들면, 쉴때 듣는 잔잔한 음악, 운전할때 듣는 경쾌한 음악 이런것들이 갖는 패턴이 서로 다를 것은 듣자마자 파악할 수 있고, 만일 예상과 다른 패턴이 등장하면 이는 심리패턴과 연결되서 직감적으로 인지 할 수 있게 됩니다.
어딘가 과학 유투브 채널에서 본 내용인데, 오디오 주파수의 패턴 조합, 즉 화음이 연결된 심리상태 매핑 데이타는 인류가 자연선택설로 진화하면서 DNA에 새겨진 데이타라고 합니다. 
이는 시계열로 오디오를 분석할때는 직관적으로 알기 어렵지만, 보통 주파수 분석을 하면 화성학에 맞는 거의 정확한 패턴을 확인할 수 있고, 이것으로 새로운 음악이라도 품질을 판단할 수 있는 근거가 됩니다.
춤이 더 어려워 보이는 이유는, 시계열에서 오디오보다 훨씬 복잡한 입력차원이 존재한다고 생각해서 그렇습니다.
그렇지 않습니다.
춤이 더 패턴 분석하기 쉽습니다. 
시계열에서 발생하는 데이타 간격이 더 넓고, 모든 데이타를 따질 필요가 없이, 90% 정도 데이타는 필터아웃해도 됩니다.
또한 각 데이타에서 발생하는 차원이 오디오 처럼 1차원은 아니지만 이미지의 3차원(W x H x level)을 모두 쓰지 않고 특이점을 정할수 있습니다.
한 스텝이 펼쳐지는 짧은 순간에 한 특이점에서 다른 특이점으로 상태가 전이할때는 관절과 운동범위의 제약으로 정해진 루트이외엔 불가한 상태라 연산에서 제외할 수 있습니다. 
즉 컴퓨터로 분석하기엔 더 적은 입력데이타로 발생한 패턴을 분석하게 되니 부담이 더 적고 쉬운문제가 됩니다.
그래서 보컬, 피아노, 기타등 오디오 패턴을 분석하는 할때는 주파수 기반 분석을 하는 것이 효율적이고, 춤의 이미지 패턴 분석 할때는 시계열 기반 분석을 하는 것이 효율적입니다.
조금더 정확하게 보자면, GT(=댄서님 클래스 영상)가 있고, 이를 추종하는 영상(=내 연습영상)이 존재하고, 이를 시계열에서 대부분 필터아웃하고, 특이점을 찾아서 상태전이가 잘 되는지 그 유사도를 측정하는 식으로 알고리즘을 개발해 나갈수 있습니다.
여기에 KPOP이란 제약사항으로 좀더 최적화 할 수 있습니다.
KPOP은 보통 4/4박자, 평균 120bpm 로 볼수 있습니다.
120bpm이란 1분에 120개의 비트가 발생한다는 뜻으로(=저도 첨엔 몰랐습니다.ㅎ) 0.5초에 한번씩 비트가 발생하고, 이 리듬에 맞춰서 몸을 움직이게 됩니다.
즉 비트사운드가 발생할때 어떤 동작이 되기로 약속이 된것, 마치 리듬액션 게임처럼 정해진 순간에 정해진 동작을 해야 하는 단순한? 게임규칙을 갖고 있습니다.
물론 평가 규칙이 단순한 것이지 익히는게 쉽다고는 안했습니다.
이 약속된 동작이 다시 다차원이니깐, 즉 양팔, 양다리, 스텝, 몸통, 허리, 어깨 이런 주요포지션을 한번에 기억했다가 비트사운드 터질때마다 계속 바꿔줘야 하니 아무래도 어렵습니다.
차원의 문제로 뭐가 어렵냐고 한다면, 댄스가 가장 어렵고, 그 다음이 기악, 그리고 어쨋든 오디오 level 한개만 갖는 보컬이 쉽다고 하겠습니다.
즉 춤을 잘추고 싶으면, 머리가 좋아야 합니다.
몸치는 정확히 몸이 안좋은게 아니라 머리가 안좋은 것입니다.
물론 많은 연습으로 운동을 기억하는 소뇌가 패턴을 외우게 되었는데, 그 패턴이 자꾸 반복되면, 캐시 입출력이 되니깐 상당한 도움이 될거라 생각합니다.
